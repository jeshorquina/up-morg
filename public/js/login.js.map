{"version":3,"sources":["login.js"],"names":["DomHelper","ClearHTML","el","innerHTML","AppendHTML","addition","this","undefined","AlertFactory","GenerateAlert","container","value","type","clearHtml","CreateAlert","message","GenerateDangerAlert","data","GenerateSuccessAlert","HttpHelper","callEndpoint","endpoint","method","callback","request","XMLHttpRequest","onload","readyState","DONE","status","responseText","open","send","UNPROCESSABLE_ENTITY","OK","Get","calback","Post","UrlHelper","Redirect","url","delay","setTimeout","window","location","document","getElementById","addEventListener","event","preventDefault","LoginController","Login","getAttribute","ValidateLoginData","username","password","LoginCallback","JSON","parse","redirect_url","source","form","elements","FormData"],"mappings":"CAAA,SAAWA,GAETA,EAAUC,UAAY,SAAUC,GAC9BA,EAAGC,UAAY,IAGjBH,EAAUI,WAAa,SAAUF,EAAIG,GACnCH,EAAGC,UAAYD,EAAGC,UAAYE,IAG/BC,KAAKN,UAA+BO,QAAlBD,KAAKN,aAA+BM,KAAKN,WAE9D,SAAWA,EAAWQ,GAUpB,QAASC,GAAcC,EAAWC,EAAOC,EAAMC,GACzCA,GACFb,EAAUC,UAAUS,GAEtBV,EAAUI,WAAWM,EAAWI,EAAYH,EAAOC,IAGrD,QAASE,GAAYC,EAASH,GAC5B,MAAO,qBAAuBA,EAAO,KAAOG,EAAU,SAhBxDP,EAAaQ,oBAAsB,SAAUN,EAAWO,EAAMJ,GAC5DJ,EAAcC,EAAWO,EAAM,eAAgBJ,IAGjDL,EAAaU,qBAAuB,SAAUR,EAAWO,EAAMJ,GAC7DJ,EAAcC,EAAWO,EAAM,gBAAiBJ,KAelDb,UACAM,KAAKE,aAAqCD,QAArBD,KAAKE,gBAAkCF,KAAKE,cAEnE,SAAWW,GAaT,QAASC,GAAaC,EAAUC,EAAQL,EAAMM,GAC5C,GAAIC,GAAU,GAAIC,eAElBD,GAAQE,OAAS,WACXF,EAAQG,YAAcF,eAAeG,MACvCL,EAASC,EAAQK,OAAQL,EAAQM,eAGrCN,EAAQO,KAAKT,EAAQD,GACrBG,EAAQQ,KAAKf,GApBfE,EAAWc,qBAAuB,IAClCd,EAAWe,GAAK,IAEhBf,EAAWgB,IAAM,SAAUd,EAAUe,GACnChB,EAAaC,EAAU,MAAO,GAAIE,WAGpCJ,EAAWkB,KAAO,SAAUhB,EAAUJ,EAAMM,GAC1CH,EAAaC,EAAU,OAAQJ,EAAMM,KAetCjB,KAAKa,WAAiCZ,QAAnBD,KAAKa,cAAgCb,KAAKa,YAEhE,SAAWmB,GAETA,EAAUC,SAAW,SAAUC,EAAKC,GAElCC,WAAW,WACTC,OAAOC,SAAWJ,GACjBC,KAGJnC,KAAKgC,UAA+B/B,QAAlBD,KAAKgC,aAA+BhC,KAAKgC,WAG5DO,SACGC,eAAe,cACfC,iBAAiB,SAAU,SAAUC,GACpCA,EAAMC,iBACNC,gBAAgBC,MAAM7C,KAAK8C,aAAa,kBAI9C,SAAW5C,EAAcW,EAAYmB,EAAWY,GAiB9C,QAASG,GAAkBC,EAAUC,GAInC,OAAO,EAGT,QAASC,GAAc3B,EAAQC,GAE7B,GAAIb,GAAOwC,KAAKC,MAAM5B,GAClBpB,EAAYmC,SAASC,eAAe,gBAEpCjB,IAAUV,EAAWc,sBACC1B,QAApBU,EAAe,UACjBT,EAAaQ,oBAAoBN,EAAWO,EAAe,UAAG,GAExCV,QAApBU,EAAe,UACjBT,EAAaQ,oBAAoBN,EAAWO,EAAe,UAAG,IAGzDY,GAAUV,EAAWe,KAC5B1B,EAAaU,qBAAqBR,EAAWO,EAAKF,SAAS,GAC3DuB,EAAUC,SAAStB,EAAK0C,aAAc,MArC1CT,EAAgBC,MAAQ,SAAUS,GAEhC,GAAIC,GAAOhB,SAASC,eAAe,cAC/BQ,EAAWO,EAAKC,SAAmB,SAAEnD,MACrC4C,EAAWM,EAAKC,SAAmB,SAAEnD,KAEzC,IAAI0C,EAAkBC,EAAUC,GAAW,CAEzC,GAAIlC,GAAWuC,EAAS,eACpB3C,EAAO,GAAI8C,UAASF,EAExB1C,GAAWkB,KAAKhB,EAAUJ,EAAMuC,MA+BpChD,aAAcW,WAAYmB,UAC1BhC,KAAK4C,gBAA2C3C,QAAxBD,KAAK4C,mBAAqC5C,KAAK4C","file":"login.js","sourcesContent":["(function (DomHelper) {\n\n  DomHelper.ClearHTML = function (el) {\n    el.innerHTML = \"\";\n  }\n\n  DomHelper.AppendHTML = function (el, addition) {\n    el.innerHTML = el.innerHTML + addition;\n  }\n\n})(this.DomHelper = (this.DomHelper == undefined) ? {} : this.DomHelper);\n\n(function (DomHelper, AlertFactory) {\n\n  AlertFactory.GenerateDangerAlert = function (container, data, clearHtml) {\n    GenerateAlert(container, data, \"alert-danger\", clearHtml);\n  }\n\n  AlertFactory.GenerateSuccessAlert = function (container, data, clearHtml) {\n    GenerateAlert(container, data, \"alert-success\", clearHtml);\n  }\n\n  function GenerateAlert(container, value, type, clearHtml) {\n    if (clearHtml) {\n      DomHelper.ClearHTML(container);\n    }\n    DomHelper.AppendHTML(container, CreateAlert(value, type));\n  }\n\n  function CreateAlert(message, type) {\n    return \"<div class='alert \" + type + \"'>\" + message + \"</div>\";\n  }\n\n})(\n  DomHelper,\n  this.AlertFactory = (this.AlertFactory == undefined) ? {} : this.AlertFactory\n  );\n(function (HttpHelper) {\n\n  HttpHelper.UNPROCESSABLE_ENTITY = 422;\n  HttpHelper.OK = 200;\n\n  HttpHelper.Get = function (endpoint, calback) {\n    callEndpoint(endpoint, \"GET\", \"\", callback);\n  }\n\n  HttpHelper.Post = function (endpoint, data, callback) {\n    callEndpoint(endpoint, \"POST\", data, callback);\n  }\n\n  function callEndpoint(endpoint, method, data, callback) {\n    var request = new XMLHttpRequest();\n\n    request.onload = function () {\n      if (request.readyState == XMLHttpRequest.DONE) {\n        callback(request.status, request.responseText);\n      }\n    }\n    request.open(method, endpoint);\n    request.send(data);\n  }\n\n})(this.HttpHelper = (this.HttpHelper == undefined) ? {} : this.HttpHelper);\n\n(function (UrlHelper) {\n\n  UrlHelper.Redirect = function (url, delay) {\n\n    setTimeout(function () {\n      window.location = url;\n    }, delay);\n  }\n\n})(this.UrlHelper = (this.UrlHelper == undefined) ? {} : this.UrlHelper);\n\n{\n  document\n    .getElementById(\"login-form\")\n    .addEventListener(\"submit\", function (event) {\n      event.preventDefault();\n      LoginController.Login(this.getAttribute(\"data-source\"));\n    });\n}\n\n(function (AlertFactory, HttpHelper, UrlHelper, LoginController) {\n\n  LoginController.Login = function (source) {\n\n    var form = document.getElementById(\"login-form\");\n    var username = form.elements[\"username\"].value;\n    var password = form.elements[\"password\"].value;\n\n    if (ValidateLoginData(username, password)) {\n\n      var endpoint = source + \"action/login\";\n      var data = new FormData(form);\n\n      HttpHelper.Post(endpoint, data, LoginCallback);\n    }\n  }\n\n  function ValidateLoginData(username, password) {\n\n    // TODO: Validate the username and password sematics-wise\n\n    return true;\n  }\n\n  function LoginCallback(status, responseText) {\n\n    var data = JSON.parse(responseText);\n    var container = document.getElementById(\"notifications\");\n\n    if (status == HttpHelper.UNPROCESSABLE_ENTITY) {\n      if (data['username'] != undefined) {\n        AlertFactory.GenerateDangerAlert(container, data['username'], true);\n      }\n      if (data['password'] != undefined) {\n        AlertFactory.GenerateDangerAlert(container, data['password'], false);\n      }\n    }\n    else if (status == HttpHelper.OK) {\n      AlertFactory.GenerateSuccessAlert(container, data.message, true);\n      UrlHelper.Redirect(data.redirect_url, 1000);\n    }\n  }\n\n})(\n  AlertFactory, HttpHelper, UrlHelper,\n  this.LoginController = (this.LoginController == undefined) ? {} : this.LoginController\n  );\n"]}